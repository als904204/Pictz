<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<head>
  <title>토픽 요청 상세보기</title>
  <link rel="stylesheet" th:href="@{/css/suggest-detail.css}">
  <script defer th:src="@{/js/suggest-detail.js}"></script>
  <script defer th:src="@{/js/suggest-update.js}"></script>
</head>

<body>
<div layout:fragment="content">
  <div class="container mt-5">
    <a href="#" class="btn btn-outline-secondary mb-4" onclick="goBack(); return false;">
      <i class="bi bi-arrow-left"></i> 뒤로가기
    </a>
    <div id="error-message" class="alert alert-danger text-center" role="alert" style="display: none;">
      에러가 발생했습니다. 다시 시도해 주세요.
    </div>

    <div id="detail-container" style="display: none;">
      <div class="card shadow-sm mb-4">
        <div class="card-body">

          <!-- 제목 섹션 -->
          <div class="border-bottom pb-3 mb-4">
            <div class="title-container d-flex align-items-center">
              <h3 id="detail-title" class="card-title fw-bold mb-0 me-3"></h3>
              <input type="text" id="titleInput" class="form-control me-3" style="display: none; max-width: 400px; required">
              <button id="editTitleButton" class="btn btn-outline-secondary btn-sm me-2 edit-button" onclick="editTitle()">
                <i class="bi bi-pencil"></i> 수정
              </button>
              <button id="saveTitleButton" class="btn btn-primary btn-sm me-2 save-button" onclick="saveTitle()" style="display: none;">
                <i class="bi bi-check"></i> 저장
              </button>
            </div>
          </div>

          <!-- 설명 섹션 -->
          <div class="bg-light p-4 rounded mb-4">
            <div class="content-container d-flex align-items-center mb-3">
              <h5 class="mb-0 me-3">
                <i class="bi bi-card-text"></i> 설명
              </h5>
              <button id="editContentButton" class="btn btn-outline-secondary btn-sm me-2 edit-button" onclick="editContent()">
                <i class="bi bi-pencil"></i> 수정
              </button>
              <button id="saveContentButton" class="btn btn-primary btn-sm me-2 save-button" onclick="saveContent()" style="display: none;">
                <i class="bi bi-check"></i> 저장
              </button>
            </div>
            <p id="detail-content" class="card-text lead" style="display: block;"></p>
            <textarea id="contentTextarea" class="form-control edit-function" rows="5" style="display: none;"></textarea>
          </div>

          <div class="bg-light p-4 rounded mb-4">
            <div class="col-md-6 mb-2">
              <strong><i class="bi bi-flag"></i> 상태:</strong>
              <span id="detail-status" class="badge ms-2"></span>
            </div>
          </div>

          <!-- 거부 이유 섹션 -->
          <div class="mt-3 p-3 bg-light rounded mb-4" id="rejectReason" style="display: none">
            <div class="d-flex align-items-center mb-2">
              <i class="bi bi-exclamation-circle text-danger me-2"></i>
              <h5 class="mb-0 text-danger">거부 사유</h5>
            </div>
            <p id="detailRejectReason" class="mb-0 ms-4 font-weight-bold"></p>
          </div>

          <section class="mb-4">
            <div class="border-start border-4 border-secondary ps-3 mb-3">
              <h4 class="section-title fw-bold">
                <i class="bi bi-image"></i> 썸네일 이미지
              </h4>
            </div>
            <div class="thumbnail-container bg-light p-3 rounded">
              <img id="detailThumbnail" src="" alt="썸네일" class="thumbnail-image shadow-sm mb-2">
              <input type="file" id="thumbnailUpload" accept="image/*" class="form-control mt-2 edit-function" onchange="uploadThumbnail()">
            </div>
          </section>

          <!-- 선택지 이미지 섹션 -->
          <section class="mb-4">
            <div class="border-start border-4 border-secondary ps-3 mb-3">
              <h4 class="section-title fw-bold">
                <i class="bi bi-images"></i> 선택지 이미지 목록
              </h4>
            </div>
            <div id="detailImages" class="choice-images-container bg-light p-3 rounded">
            </div>
          </section>

          <hr class="my-4 opacity-75">

          <div id="updateButtonContainer" class="justify-content-center my-4" style="display: none;">
            <a href="#" class="btn btn-outline-success" onclick="goUpdate(); return false;">
              <i class="bi bi-save-right"></i> 컨텐츠 재신청
            </a>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
